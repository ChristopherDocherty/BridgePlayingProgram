#ifndef BridgeMCTreeNode_h
#define BridgeMCTreeNode_h

#include "MCTreeNode.hpp"
#include "bridge/bridgeGamestate.hpp"

#include <boost/json.hpp>

#include <memory>
#include <string>

namespace Bridge {

class BridgeMCTreeNode : public MCTreeNode {


    public:

        BridgeMCTreeNode(const std::string& initialGamestateJsonFilepath= "@CONFIG_BINARY_DIR@/bridge/bridgeGamestate.json");
        BridgeMCTreeNode(MCTreeNode* parent);


        void notify() override;


        std::string makeMoveMCTS(int validMoveNumber) {return pGamestate->makeMoveMCTS(validMoveNumber);}; 
        //TODO: add makeRandomMoveMethod for simulation

        std::string makeMove(const std::string suit, const std::string rank) {return pGamestate->makeMove(suit, rank);};
        
        int getValidMoveCnt() const {return pGamestate->getValidMoveCnt();};

        std::string getGamestate() override {return boost::json::serialize(pGamestate->getGamestateJson());};
        void setGamestate(std::string gamestate) override;


    private:

        std::unique_ptr<BridgeGamestate> pGamestate;

        std::string loadGamestateJsonFromFile(const std::string& filepath="@CONFIG_BINARY_DIR@/bridge/bridgeGamestate.json");

        std::string getGamestateJsonString() {return boost::json::serialize(pGamestate->getGamestateJson());};
};



}
#endif
